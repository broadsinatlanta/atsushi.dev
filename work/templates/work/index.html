{% extends 'home/layout.html' %}
{% load static extra_tags %}

{% block stylesheet %}
    <link rel="stylesheet" href="{% static 'work/css/desktop/index.css' %}">
{% endblock %}

{% block javascript %}
    <script src="{% static 'work/js/index.js' %}"></script>
{% endblock %}

{% block title %}
    All Projects
{% endblock %}

{% block main %}

    {% if user.is_authenticated %}
        <h2 id="new-proj"><a href="{% url 'new-project' %}" uk-icon="icon: plus"></a></h2>
    {% endif %}

    <div id="proj-all" class="uk-container" uk-filter="target: .js-filter">
        <div class="projects">
            <ul class="js-filter uk-text-center uk-grid-collapse uk-child-width-1-2@s" uk-grid uk-height-match="target: > li > div > .uk-card">
                {% for p in all_projects %}
                    <li class="tag-all {% for l in p.get_languages %}tag-{{ l|lower }} {% endfor %} {% for t in p.get_stack %}{% with lower_t=t|lower %} tag-{{ lower_t|replace_space }} {% endwith %}{% endfor %} {% for t in p.get_tags %}{% with lower_t=t|lower %} tag-{{ lower_t|replace_space }} {% endwith %}{% endfor %}">

                            <div>
                                <div class="uk-card uk-card-default uk-grid-collapse uk-margin-small-left uk-margin-small-right uk-margin-medium-bottom" uk-grid>
                                    <div class="uk-card-media-top uk-cover-container fit-bg-img b-shadow card-img"
                                    data-src="{{ p.projectspecs.preview.url }}"
                                    uk-img>
                                    </div>
                                    <div>
                                        <div class="uk-card-body">
                                            <h3 class="uk-card-title"><a href="{% url 'view-project' p.url_slug %}" class="link-3">{{ p.name }}</a></h3>
                                            <p class="serif">{{ p.description|linebreaks }}</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        
                    </li>
                {% endfor %}
            </ul>
        </div>

        <div id="controls">
            <ul class="uk-nav-default uk-nav-parent-icon uk-margin-small-bottom" uk-nav id="control-options">
                <li uk-filter-control=".tag-all"><a href="#" class="serif">View All</a></li>
                {% for key, value in filters.items %}
                    <li class="uk-parent">
                        <a href="#" class="serif">{{ key }}</a>
                        <ul class="uk-nav-sub">
                            {% for v in value %}
                                {% with lower_v=v|lower %}
                                    <li uk-filter-control=".tag-{{ lower_v|replace_space }}"><a href="#" class="serif">{{ v }}</a></li>
                                {% endwith %}
                            {% endfor %}
                        </ul>
                    </li>
                {% endfor %}
            </ul>
            <a id="toggle-filter" class="uk-margin-small-top serif">Filter <span uk-icon="icon: cog"></span></a>
        </div>
    </div>

{% endblock %}
